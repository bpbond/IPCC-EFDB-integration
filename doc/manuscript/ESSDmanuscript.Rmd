---
title: Informing IPCC accounting of forest carbon using the global forest carbon database (ForC v4.0)
journal: "`r rticles::copernicus_journal_abbreviations(journal_name = 'essd')`"
author:
  - given_name: Madison 
    surname: Williams
    affiliation: "1"
  - given_name: Valentine
    surname: Herrmann
    affiliation: "1"
  - given_name: Rebecca
    surname: Banbury Morgan
    affiliation: "1,2" 
  - given_name: Ben 
    surname: Bond-Lamberty
    affiliation: "3" 
  - given_name: Susan 
    surname: Cook-Patton
    affiliation: "4" 
  - given_name: Helene
    surname: Muller-Landau
    affiliation: "5" 
  - given_name: Camille
    surname: Piponiot
    affiliation: "6" 
  - given_name: Teagan
    surname: Rogers
    affiliation: "1"
  - given_name: Kristina J.
    surname: Anderson-Teixeira
    affiliation: "1,5 *"
    email: teixeirak@si.edu
    corresponding: true
affiliation:
  - code: 1
    address: Center for Conservatiton Ecology, Smithsonian Conservation Biology Institute, Front Royal, VA, United States
  - code: 2
    address: School of Geography, University of Leeds, Leeds, UK
  - code: 3
    address: Joint Global Change Research Institute, Pacific Northwest National Laboratory, College Park, MD, United States
  - code: 4
    address: The Nature Conservancy; Arlington VA 22203, USA
  - code: 5
    address: Forest Global Earth Observatory, Smithsonian Tropical Research Institute, Panama, Republic of Panama
  - code: 6
    address: CIRAD, Montpellier, France
abstract: |
  Forests are critical for climate change mitigation and consitute a substantial portion of planned emissions reductions under the 2015 Paris Agreement.
  Yet, the efficacy of greenhouse gas (GHG) mitigation planning and reporting is dependent upon the quality of available emission factors data, including forest carbon (C) stocks and changes therein.
  Tens of thousands of relevant forest C estimates have been published, yet are not readily accesible to the practitioners compiling national greenhouse gas inventories. 
  Many of these data have, however, been compiled in the Global Forest C database (ForC; https://forc-db.github.io/) and stand to be of value to greenhouse gas accounting if made available through the Emission Factor Database (EFDB) of the International Panel on Climate Change (IPCC).
  Here, we develop and document a process for semi-automated transfer of data from ForC into the EFDB, assess the data available and transferred to date, and provide recommendations for improving forest data collection, analysis, and reporting to improve accounting of forest-sector GHG emissions and removals.
  We begin by reconciling terminology and mapping ForC fields into EFDB.
  This process required some updates to the ForC database structure, leading to the release of a new version of ForC (v4.0; described here).
  At the time of writing, ForC contained ## values that would qualify for inclusion in the EFDB, ## of which have been transferred to date.
  (Some analysis of representation/ gaps.)
  <!-- -->
  In the future, forest C estimates in EFDB can be improved through targetted research to fill critical gaps, reporting of information required by IPCC, and continued submission of data from scientific publications to the EFDB.

bibliography: references.bib
running:
  title: IPCC forest C accounting with ForC
  author: Williams et al.
competinginterests: |
  The authors declare no competing interests.
# OPTIONAL:
algorithms: true
# See https://publications.copernicus.org/for_authors/licence_and_copyright.html, normally used for transferring the copyright, if needed. 
# Note: additional copyright statements for affiliated software or data need to be placed in the data availability section. 
copyrightstatement: |
  The author's copyright for this publication is transferred to institution/company. 
### Note: unless stated otherwise, software and data affiliated with the manuscript are assumed to be published under the same licence as the article (currently Creative Commons 4.0)
availability:
  #  use this to add a statement when having only software code available
  #  use this to add a statement when having only data sets available
  #code: |
  #data: |
  codedata: |
    use this to add a statement when having data sets and software code available
authorcontribution: |
  (fill this in)
disclaimer: |
acknowledgements: |
  Thank you to all researchers who collected and published the data contained in ForC, and to all research assistants and collaborators who have helped to build the database.
  Funding for this study was provided by Bezos Earth Fund to The Nature Conservancy, the Institute for Global Environmental Strategies, WLS(?)
appendix: |
   \section{Mapping ForC to EFDB}
   
   CURRENT TABLE 2 GOES HERE
   
   \section{Updates to ForC}
   
   CURRENT TABLE 3 GOES HERE
   
output:
  rticles::copernicus_article: default
  bookdown::pdf_book:
    base_format: rticles::copernicus_article # for using bookdown features like \@ref()
---


<!--**Important**: Always double-check with the official manuscript preparation guidelines at [https://publications.copernicus.org/for_authors/manuscript_preparation.html](https://publications.copernicus.org/for_authors/manuscript_preparation.html), especially the sections "Technical instructions for LaTeX" and "Manuscript composition".
Please contact Daniel NÃ¼st, `daniel.nuest@uni-muenster.de`, with any problems.-->

\introduction[Introduction]

Forests are critical to our management of greenhouse gases. 
The influence the forests have on atmospheric carbon has made forest data increasingly valuable. 

**Forests play a central role in international plans for climate change mitigation [@unfccc_adoption_2015].**
As of 2016, forest-based mitigation accounted for 26% of total planned greenhouse gas mitigation within Nationally Determined Contributions under the Paris Agreement [@grassi_key_2017].
Effective forest-based climate change mitigation requires solid scientific data [@anderson-teixeira_effective_2022].

**The International Panel on Climate Change (IPCC) provides guidance for national greenhouse gas (GHG) inventories for reporting to the United Nations Framework Convention on Climate Change [UNFCCC, (REFS for older guidelines), @ipcc_2019_2019].**
Under this guidance, GHG inventories include all managed land, including most of the world's forest land [@ogle_delineating_2018].
The IPCC inventory guidelines include specific instructions for accounting for forest land ... [@ipcc_agriculture_2006; @ipcc_2019_2019a].
This guidance has improved as more of the relevant underlying data has become available [@requenasuarez_estimating_2019], but there remains room for continuous improvement as the science advances.
For example, @cook-patton_mapping_2020 *(summarize IPCC comparison results)*. 
Another example is @cuni-sanchez_high_2021.
*Moreover, it is useful for those compiling national greenhouse gas inventories to have access to locally-specific information, when available.*
To improve the data accessible for C accounting, the IPCC created the Emission Factor Database (EFDB; https://www.ipcc-nggip.iges.or.jp/EFDB/main.php), which is intended as a recognized library of emission factors and other parameters that can be used for estimating greenhouse gas emissions and removals.

**To ensure that planned emissions reductions are realistic, high-quality estimates of forest C stocks and fluxes must be publicly accessible.**
The EFDB is intended as a recognized library, and can be used both for efforts to tally a nation's intended or accomplished GHG reductions, or as a basis of comparison for external parties to evaluate these inventories. 
<!-- check Washington Post article on Malaysia NDC, @deng_comparing_2021 -->

**The Global Forest Carbon Database, ForC, is the largest collection of published estimates of forest carbon stocks, increments, and annual fluxes [@anderson-teixeira_forc_2018; @anderson-teixeira_carbon_2021].**
*(add stats/ details, maybe record of how ForC has grown over time)*
As such, ForC is positioned to improve forest C accounting through the transfer of data to EFDB.
The purpose of this publication is to document that process and provide recommendations for future improvements.

**Here, we**
(1) review IPCC definitions of relevant carbon stocks and increments
(2) describe mapping of ForC to IPCC's EFDB,
(3) describe updates to ForC  (ForC v4.0),
(4) summarize the data in ForC that's relevant to EFDB, identifying gaps, and
(5) provide recommendations for improving data collection, analysis, database, and accounting.


# IPCC definitions of carbon stocks and incremenets

For quantifying forest role in global C cycle, we ultimately care about:
(1) C stocks -- stores of C that would be vulnerable to release to the atmosphere upon land use change
(2) C increments -- changes in those C stocks.


## Carbon stocks
Forest ecosystem C stocks may be parsed into pools in various ways. 
IPCC parses into biomass (aboveground and belowground), dead organic matter (dead wood and litter), and soil organic matter (Table&nbsp;\@ref(table_variables)).
Quantifying these requires a one-time measurement.



```{r table_variables, eval = TRUE, echo=FALSE, warning=FALSE}
C_pools_table <- read.csv("figures_tables/C_pools.csv")
names(C_pools_table) <- stringr::str_replace_all(names(C_pools_table), "\\.", " ")

library(knitr)
library(kableExtra)
knitr::kable(C_pools_table, format = "latex",
             longtable = FALSE,
             caption = "\\textbf{Variables with definitions and measurement methods.} Definitions from IPCC Table 1.1. (See Table 1.1 in IPCC guidance).") %>%
  kableExtra::kable_styling(full_width = TRUE) %>%
  row_spec(0, bold = TRUE)
```

### Biomass
Biomass includes living vegetation, above- and below-ground.

The IPCC defines aboveground biomass as "all biomass of living vegetation, both woody and herbaceous, above the soil including stems, stumps, branches, bark, seeds, and foliage" [].

Belowground biomass is defined as "all biomass of live roots" [].

### Dead Organic Matter

Dead organic matter includes all non-living biomass that is not within the mineral soil layer and smaller than the litter size threshold.

Dead wood is defined as...

Litter is defined as including " all  non-living  biomass  with  a  diameter  less  than  a  minimum  diameter  chosen  by  the  country  (for  example 10 cm), lying dead, in various states of decomposition above the mineral or organic soil. This includes litter (OL),  fumic (OF),  and  humic (OH) layers.  Live  fine  roots  (of  less  than  the  suggested  diameter  limit for  belowground  biomass) are included in litter where they cannot be distinguished from it empirically." (2003 IPCc GPG for LULUCF (https://www.ipcc-nggip.iges.or.jp/public/gpglulucf/gpglulucf_files/Glossary_Acronyms_BasicInfo/Glossary.pdf)

### Soil Organic Matter

Soil organic matter is defined as "Includes organic carbon in mineral and organic soils (including peat) to a specified depth chosen by the country and
applied consistently through the time series. Live fine roots (of less than the suggested diameter limit for belowground biomass) are included with soil organic matter where they cannot be distinguished from it empirically."(2003 IPCc GPG for LULUCF (https://www.ipcc-nggip.iges.or.jp/public/gpglulucf/gpglulucf_files/Glossary_Acronyms_BasicInfo/Glossary.pdf)

## Carbon increments

C increments are defined as the change over time, in annual increments, in each C pool.
These may be estimated as the difference between C stocks at two time points, or as the difference between inputs and outputs to the pool (i.e., fluxes).
Quantifying these requires at least two measurements.
(*But, Can carbon increments be inferred from a single measure and a known age (i.e., the approach we used in GROA)?*)
Fluxes are the inputs and outputs to each pool. 



\clearpage
```{r, out.width = "15cm", echo = FALSE, fig.cap = "\\textbf{Schematic illustrating the carbon pools quantified under IPCC accounting; ForC variables corresponding to the stock, increment, influx and outflux; and relationships among them.} In many cases, the match of ForC variables to IPCC criteria depends upon measurement protocols (e.g., minimum DBH). Additional caveats are as follows: 1- assumes that change in foliage biomass is negligible (see note 7); 2- incomplete: excludes large branch fall; also, under IPCC definitions, outflux from aboveground biomass should include all sizes, influx to deadwood should include only above the minimum diameter chosen for dead wood; 3- incomplete: excludes belowground components;  4-incomplete: excludes breakage into pieces less than dead wood threshold size; 5-incomplete: excludes woody mortality of stems <10 cm DBH, decomposition of dead wood (aboveground and coarse roots) into sizes classified as litter, may exclude branch fall; 6- measurements often limited to decomposition of relatively fine litter and may exclude branches and stems below the dead wood size threshold and/or the more decomposed layers of the O horizon; 7 - foliage production is generally measured by collecting leaf-fall, a method that assumes that the influx = outflux (foliage biomass is roughly constant year-to-year); 8 - excludes branch fall, which is necessary for a full accounting of woody productivity but is typically assumed negligible for calculations of net biomass change."}
#this is for a two-column figure. for one-column figure, use {r, out.width = "8.3cm", echo = FALSE, fig.cap = "one column figure"}
knitr::include_graphics("figures_tables/C_variable_mapping.png")
```


# Mapping ForC to EFDB
ForC data is incredibly valuable to EFDB and there is data which is included in the ForC database that does not meet EFDB standards. There were two main EFDB guidelines which limits the amount of data we could transfer. EFDB will not accept data which has been digitized(from graph) and ForC does. 


## Carbon cycle variables

Mapping of variables is shown in Fig. 1


## Land use categories

Documented at https://github.com/forc-db/IPCC-EFDB-integration/blob/main/doc/ForC-EFDB_mapping/defining_land_subcategory.md, https://github.com/forc-db/IPCC-EFDB-integration/blob/main/doc/ForC-EFDB_mapping/IPCC_LandUse_mapping.csv, and in [issue #8](https://github.com/forc-db/IPCC_database_integration/issues/8). 


The UNFCCC requires GHG reporting for all managed lands in a country, where management is defined as "human interventions and practices have been applied to perform production, ecological or social functions" [*IPCC 2006 full report REF*]. 
This definition is applied differently across countries, and is not clearly defined by the majority of governments [@ogle_delineating_2018]. 
Given this, and because the IPCC definition of management does not necessarily match that which would be reported in scientific publications and hence in ForC, we do not transfer any classification of land management status from ForC to the EFDB, but do provide auxiliary info that may be useful in making this determination (e.g., geographical location).

# Updates to ForC  (ForC v4.0)

To support export of data to EFDB, and to improve the overall quality of the ForC database, we defined ## new variables, implemented some modest restructuring, resolved duplicate records, and conducted quality control.
This section describes changes relative to ForC v2.0 [@anderson-teixeira_forc_2018].

## Defining new variables



We added eleven increment variables to the set of named and defined variables (or 22, counting _OM and _C versions), which previously included only one (aboveground biomass increment, *delta.agb*). 
*(https://github.com/forc-db/IPCC-EFDB-integration/issues/6)*
These are directly related to C stocks as previously defined in ForC, with "*delta.*" added in front of the variable name.

Although these variables currently lack records, the structure exists such that records can be populated over time. 

To provide better definition of the previously existing variable *organic.layer*, which has a nebulous definition that reflects the varied definitions adopted by original studies, we added two clearly defined variables: *litter* (relatively undecomposed plant material/ OL horizon), and *O.horizon* (entire O-horizon, including *litter* (OL)).

## ForC restructuring


## Quality control measures
Prior to releasing ForC v4.0, we executed several quality control measures.
First, we implemented a system of continuous integration using GitHub Actions (*sensu* Kim et al. in prep) to run some automatic checks any time the master data files are updated.
Second, to improve information on geographic coordinates, we flagged and reviewed records with suspected low precision *(Issue #29)[https://github.com/forc-db/ForC/issues/229]*.
Third, to identify erroneous climate data... *(Issue #212)[https://github.com/forc-db/ForC/issues/212]*.


## Resolving duplicates


# Results

**figure: map of relevant ForC data with underlying FAO ecozones**

**(summarize the data in ForC that's relevant to EFDB, identifying gaps)**

dead wood and litter comparisons will be particularly interesting, as IPCC values are based on just a handful of references for each climate zone (table 2.2 in 2019 guidelines)

# Recommendations

(*strongly flag both useful variables that the EFDB does not track and useful variables that papers fail to include that EFDB needs*)

## Data collection and analysis needs

**(Paragraph highlighting important gaps in variables / regions)**


Several variables of value to IPCC, including standing dead wood, woody mortality, delta.agb, are not calculated and presented as frequently as are AGB and ANPP_woody, even though they can readily be derived from the same census data. 
We recommend that researchers calculate and report these, as specified below.
Furthermore, there is an opportunity to fill data gaps by calculating these from existing census data.
For example, the core census protocol of the Forest Global Earth Observatory [ForestGEO; REFS] collects the data required to calculate standing dead wood, woody mortality, and delta.agb, but these have not been calculated and reported for all sites for which the appropriate number of censuses are available (n=1 for standing dead wood, n=2 for woody mortality and delta.agb) [but see REFS].


A universal challenge in estimating biomass (living or dead) from forest census data is applying appropriate allometries to convert DBH measurements to biomass.
*(Camille/Helene can write this paragraph easily.)*

## Data reporting needs

We recommend that, unless they have some specific reason to do otherwise, researchers calculate and report the values according to IPCC standards:

  - adopt common standards for variables like min diameter of deadwood, select soil sampling increments to include a cutoff at 30.
  
  - report 95% CIs, SE, or STD and n
  
  - report C variables in article text, table, or SI table. EFDB cannot accept data digitized from figures
  
  - present calculations of all variables that would be useful to IPCC. EFDB requires that data in the database be presented in the original article, and as such cannot accept subsequent calculations. For example, if aboveground biomass and total biomass are presented, but root biomass is not presented, root biomass cannot be subsequently calculated and sent to EFDB. Similarly, fine and coarse root biomass can't be summed; soil carbon can't be summed across depth increments, etc.

For data synthesis projects, compilation can only be useful to the EFDB if they include all the required, along with transparent description on the methodology applied to derive emission factors (or have a brief description and a reference to the original source) and the original emission factor values are present (not modified/rounded).  

**Contributing data to ForC and/or EFDB directly will ensure its broader impact.**
The latter is more efficient for getting data to EFDB, but does not get the data into ForC, where it can be more broadly useful--for example, being used for basic science [e.g., @banburymorgan_global_2021; @anderson-teixeira_carbon_2021] or model benchmarking [@fer_ecosystem_2021].

## Database needs

There are plenty of relevant, published data that are not included in ForC. 
Systematic review of the literature could vastly improve data coverage.
*(There are some efforts underway, including a few that Susan can specify.)*

## IPCC 

An important challenge is that forests are changing rapidly, and data collected a decaade ago may no longer be relevant, particularly in the cases of C increments and fluxes.

Remote sensing biomass estimates include standing dead wood [@duncanson_aboveground_2021].


# Conclusions

<!--The conclusion goes here.
You can modify the section name with  `\conclusions[modified heading if necessary]`.-->

\clearpage
# Appendix A 
<!--remove number-->

```{r table_ForCfieldmapping, eval = TRUE, echo=FALSE, warning=FALSE}
library(knitr)
library(kableExtra)

ForC_variables_included <- read.csv("figures_tables/ForC_variables_included.csv")
names(ForC_variables_included) <- stringr::str_replace_all(names(ForC_variables_included), "\\.", " ")
ForC_variables_included <- ForC_variables_included[c(1:5)] #include all fields but TO_DO

knitr::kable(ForC_variables_included, format = "latex",
             longtable = TRUE,
             caption = "\\textbf{Mapping of ForC fields to EFDB.} See footnotes at end of table (still need to be properly inserted). ") %>%
  row_spec(0, bold = TRUE) %>%
kableExtra::kable_styling(full_width = TRUE, latex_options = c("repeat_header", "hold position"))

```
'Required' field indicates whether the field is required by EFDB: yes = value required; (yes) = input required, missing value acceptable if not reported; auto = present within ForC infrasructure, and therefore will always be exported to EFDB ; (no) = not required for EFDB, but required for ForC and therefore will always be exported to EFDB; no = not required, but exported to EFDB when a value is present.

** '(yes)' for most recent severe disturbance; 'no' for other history events

\clearpage
# Appendix B
<!--remove number-->

```{r table_ForCchanges, eval = TRUE, echo=FALSE, warning=FALSE, message = FALSE}
library (readr)
urlfile="https://raw.githubusercontent.com/forc-db/ForC/master/database_management_records/record_of_changes.csv"
record_of_changes <-read_csv(url(urlfile))
names(record_of_changes) <- stringr::str_replace_all(names(record_of_changes), "\\.", " ")
record_of_changes <- record_of_changes[c(1:5)] #include all fields but date of change
#record_of_changes<- record_of_changes[which(!grep("housekeeping",record_of_changes$Motivation)) , c(1:5)]  #trying to exclude rows for which Motivation = "housekeeping", but this is not working
record_of_changes[is.na(record_of_changes)]<- "" #replace NAs with blanks

library(knitr)
library(kableExtra)
knitr::kable(record_of_changes, format = "latex",
             longtable = TRUE,
             caption = "\\textbf{Table of changes to ForC fields.}") %>%
  kableExtra::kable_styling(full_width = TRUE, latex_options = c("repeat_header")) %>%
  row_spec(0, bold = TRUE)
```

